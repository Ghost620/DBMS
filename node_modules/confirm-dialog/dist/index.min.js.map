{"version":3,"sources":["index.js"],"names":["event","require","ontap","domify","template","classes","transform","transition","detect","transitionend","root","document","compatMode","body","documentElement","Confirm","msg","opt","transitionEnd","h","clientHeight","assign","top","left","overlay","height","Math","rect","getBoundingClientRect","zIndex","backgroundColor","position","w","width","createElement","el","max","padding","appendChild","border","textAlign","style","opacity","setTimeout","add","nodeType","replace","word","yes","innerHTML","no","footer","Error","alert","btn","querySelector","cleanUp","bind","end","unbind","parentNode","removeChild","reject","e","clz","target","resolve","Object","keys","from","forEach","k","to"],"mappings":"aAAA,IAAIA,MAAQC,QAAQ,UAChBC,MAAQD,QAAQ,SADhBD,QAAQC,QAAQ,WAGhBE,OAASF,QAAQ,UAFjBC,OAAQD,QAAQ,eAIhBG,SAAWH,QAAQ,iBAHnBI,UAAUJ,OAAQK,UAKlBC,WAAaC,OAAOD,WAJpBJ,cAAgBK,OAACC,cAMjBC,KAA4B,cAArBC,SAASC,WAA0BD,SAASE,KAAOF,SAASG,gBAEvE,SAASC,QAAQC,EAAKC,GANtBA,EAAIb,GAAWH,GAQb,IAAIY,EAAOF,SAASE,KAPlBP,EAAYE,SAAOF,cAAvB,OACAD,QAAIE,GAAaC,IAAM,mBACvB,IAAIU,EAAAA,SAAgBV,gBAAOC,wBACvBC,EAAIA,KAAGC,YASLQ,EAAIT,KAAKU,aAPfC,OAASN,EAAQC,MAAKC,CACpBA,SAAS,WACTK,IAAIT,EACJU,KAAIC,EACJnB,MAAQmB,EAAAA,KACRC,OAAQC,KAAGf,IAAQgB,EAACb,OAAAA,GAAgBc,KACpCC,OAAQnB,IACRoB,gBAAaV,kBAEXW,EAAAA,YAAUP,GACVF,IAAAA,EAFoBH,EAAA,EAAA,GAGpBI,EAHoBS,EAAA,EAAA,IAIpBC,EAAOD,SAJaE,cAAA,OA6BpBC,GAxBAV,OAAAA,EAAQC,MAAKU,CACbP,SAAQ,QACRC,IAAAA,EAAAA,KAPFO,QAAA,OASAxB,OAAKyB,IACLC,OAAUpB,iBACVqB,UAAY,SACZP,MAAStB,QACTU,KAAOc,EAAD,KACJJ,QAAQ,EACRT,gBAFe,SAIfO,EAAAA,MAAMvB,WAJS,aAKfiC,EAAME,MAAElC,YALO,mBAMfiC,EAAAA,MAAAA,YANe,iDAOfP,WAAO,WACPV,EAAAA,MAAMA,WARS,WASfmB,EAAAA,MAASA,QATM,IAUfZ,EAAAA,MAAAA,gBAAiB,mBAVnB,IAYGW,EAAHA,OACAjB,OAAQiB,EAAAA,MAAMlC,EAAAA,OAEdoC,QAAAA,GAAWC,IAAA,kBACAtC,iBAAAA,EACT6B,EAAGM,UAAMC,QAAT1B,EAAA,aACAQ,CAAAA,GAAcM,IAANW,EAARI,SAEF,MAAQJ,IAAAA,MAAO,WAAAzB,EAAA,oBALLmB,EAAAG,YAAVtB,GAOCH,EAAAyB,YAAAH,GAUD/B,SAAWA,SAAS0C,QAAQ,WAAY,SAAUC,GATlD1C,MAAYuC,SAAZvC,EAWWY,EAAI+B,KAAO,MAVH,QAARhC,EACNiC,EAAHC,IAAe,UADb,IAIH,IAFMC,EAEAhD,OAAAC,UAEN,GADC+B,EAAAG,YAAUc,GACXnC,EAAAoC,MAAA,CAYC,IAAIC,EAAMH,EAAOI,cAAc,OAXjC1C,EAAKyB,WAAYH,YAAjBmB,GAGI,SAAAE,IACDxD,MAFDyD,KAEWV,EAAI7B,cAAY,SAAAwC,IACzB1D,MAAA2D,OAAOxB,EAAUjB,cAAjBwC,GACDvB,EAAAyB,YAAA/C,EAAAgD,YAAA1B,KAEHA,EAAIgB,MAAMT,QAAUtC,EAClB+B,EAACG,MAAAA,WAAH,oBAaEzB,EAAKgD,YAAYrC,GAVjB8B,OAAIM,IAAAA,QAAWC,SAAYP,EAA3BQ,GACD5D,MAAAiD,EAAA,SAAAY,GAcG,IAAIC,EAAM3D,QAAQ0D,EAAEE,QAZxBD,EAASR,IAAT,QACExD,IACEA,KACO4D,EAAAA,IAAY/C,QAFrB2C,IAIGf,SAOD,SAAApB,OAAUhB,EAAAA,GAGR6D,OAWNC,OAAOC,KAAKC,GAAMC,QAAQ,SAAUC,GAbhCC,EAAAD,GAAIP,EAAAO,KAEFL,EAGAJ,OAAAA,QAAM/C","file":"index.min.js","sourcesContent":["var event = require('events')\nvar ontap = require('ontap')\nvar classes = require('classes')\nvar domify = require('domify')\nvar detect = require('prop-detect')\nvar template = require('./footer.html')\nvar transform = detect.transform\nvar transition = detect.transition\nvar transitionEnd = detect.transitionend\nvar root = document.compatMode=='BackCompat'? document.body : document.documentElement\n\nfunction Confirm(msg, opt) {\n  opt = opt || {}\n  var body = document.body\n  var overlay = document.createElement('div')\n  classes(overlay).add('confirm-overlay')\n  var rect = document.documentElement.getBoundingClientRect()\n  var w = root.clientWidth\n  var h = root.clientHeight\n  assign(overlay.style, {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: w + 'px',\n    height: Math.max(rect.height, h) + 'px',\n    zIndex: 998,\n    backgroundColor: 'rgba(0,0,0,0)'\n  })\n  body.appendChild(overlay)\n  var top = h/2 - 50\n  var left = w/2 - 100\n  var el = document.createElement('div')\n  assign(el.style, {\n    position: 'fixed',\n    top: top + 'px',\n    padding: '10px',\n    zIndex: 999,\n    border: '1px solid #000',\n    textAlign: 'center',\n    width: '200px',\n    left: left + 'px',\n    opacity: 0,\n    backgroundColor: '#fff'\n  })\n  el.style[transform] = 'scale(0.6)'\n  overlay.style[transition] = 'all 500ms linear'\n  el.style[transition] = 'all 250ms cubic-bezier(0.04, 0.76, 0.41, 0.99)'\n  setTimeout(function () {\n    el.style[transform] = 'scale(1)'\n    el.style.opacity = '1'\n    overlay.style.backgroundColor = 'rgba(0,0,0,0.4)'\n  }, 20)\n  if (opt.style) {\n    assign(el.style, opt.style)\n  }\n  classes(el).add('confirm-active')\n  if (typeof msg === 'string') {\n    el.innerHTML = '<div>' + msg + '</div>'\n  } else if (msg.nodeType === 1){\n    el.appendChild(msg)\n  } else {\n    throw new Error('typeof [' + msg + '] not recognized')\n  }\n  body.appendChild(el)\n  template = template.replace(/\\{\\w+\\}/g, function (word) {\n    if (word == '{yes}') {\n      return opt.yes || 'Yes'\n    } else if (word == '{no}') {\n      return opt.no || 'No'\n    }\n  })\n  var footer = domify(template)\n  el.appendChild(footer)\n  if (opt.alert) {\n    var btn = footer.querySelector('.no')\n    btn.parentNode.removeChild(btn)\n  }\n\n  function cleanUp() {\n    event.bind(el, transitionEnd, function end() {\n      event.unbind(el, transitionEnd, end)\n      if (el.parentNode) body.removeChild(el)\n    })\n    el.style.opacity = 0\n    el.style[transform] = 'translateY(-100%)'\n    body.removeChild(overlay)\n  }\n\n  return new Promise(function (resolve, reject) {\n    ontap(footer,function (e) {\n      var clz = classes(e.target)\n      if (clz.has('yes')) {\n        cleanUp()\n        resolve()\n      } else if (clz.has('no')) {\n        cleanUp()\n        reject()\n      }\n    })\n  })\n}\n\n\nfunction assign(to, from) {\n  Object.keys(from).forEach(function (k) {\n    to[k] = from[k]\n  })\n  return to\n}\n\nmodule.exports = Confirm\n"]}