{"version":3,"sources":["index.js"],"names":["event","require","ontap","classes","domify","detect","template","transform","transition","transitionEnd","transitionend","root","document","compatMode","body","documentElement","Confirm","msg","opt","overlay","createElement","add","rect","getBoundingClientRect","w","clientWidth","h","clientHeight","assign","style","position","top","left","width","height","Math","max","zIndex","backgroundColor","appendChild","el","padding","border","textAlign","opacity","setTimeout","innerHTML","nodeType","Error","replace","word","yes","no","footer","alert","btn","querySelector","parentNode","removeChild","cleanUp","bind","end","unbind","Promise","resolve","reject","e","clz","target","has","to","from","Object","keys","forEach","k","module","exports"],"mappings":";;AAAA,IAAIA,KAAK,GAAGC,OAAO,CAAC,QAAD,CAAnB;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,OAAD,CAAnB;;AACA,IAAIE,OAAO,GAAGF,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIG,MAAM,GAAGH,OAAO,CAAC,QAAD,CAApB;;AACA,IAAII,MAAM,GAAGJ,OAAO,CAAC,aAAD,CAApB;;AACA,IAAIK,QAAQ,GAAGL,OAAO,CAAC,eAAD,CAAtB;;AACA,IAAIM,SAAS,GAAGF,MAAM,CAACE,SAAvB;AACA,IAAIC,UAAU,GAAGH,MAAM,CAACG,UAAxB;AACA,IAAIC,aAAa,GAAGJ,MAAM,CAACK,aAA3B;AACA,IAAIC,IAAI,GAAGC,QAAQ,CAACC,UAAT,IAAqB,YAArB,GAAmCD,QAAQ,CAACE,IAA5C,GAAmDF,QAAQ,CAACG,eAAvE;;AAEA,SAASC,OAAT,CAAiBC,GAAjB,EAAsBC,GAAtB,EAA2B;AACzBA,EAAAA,GAAG,GAAGA,GAAG,IAAI,EAAb;AACA,MAAIJ,IAAI,GAAGF,QAAQ,CAACE,IAApB;AACA,MAAIK,OAAO,GAAGP,QAAQ,CAACQ,aAAT,CAAuB,KAAvB,CAAd;AACAjB,EAAAA,OAAO,CAACgB,OAAD,CAAP,CAAiBE,GAAjB,CAAqB,iBAArB;AACA,MAAIC,IAAI,GAAGV,QAAQ,CAACG,eAAT,CAAyBQ,qBAAzB,EAAX;AACA,MAAIC,CAAC,GAAGb,IAAI,CAACc,WAAb;AACA,MAAIC,CAAC,GAAGf,IAAI,CAACgB,YAAb;AACAC,EAAAA,MAAM,CAACT,OAAO,CAACU,KAAT,EAAgB;AACpBC,IAAAA,QAAQ,EAAE,UADU;AAEpBC,IAAAA,GAAG,EAAE,CAFe;AAGpBC,IAAAA,IAAI,EAAE,CAHc;AAIpBC,IAAAA,KAAK,EAAET,CAAC,GAAG,IAJS;AAKpBU,IAAAA,MAAM,EAAEC,IAAI,CAACC,GAAL,CAASd,IAAI,CAACY,MAAd,EAAsBR,CAAtB,IAA2B,IALf;AAMpBW,IAAAA,MAAM,EAAE,GANY;AAOpBC,IAAAA,eAAe,EAAE;AAPG,GAAhB,CAAN;AASAxB,EAAAA,IAAI,CAACyB,WAAL,CAAiBpB,OAAjB;AACA,MAAIY,GAAG,GAAGL,CAAC,GAAC,CAAF,GAAM,EAAhB;AACA,MAAIM,IAAI,GAAGR,CAAC,GAAC,CAAF,GAAM,GAAjB;AACA,MAAIgB,EAAE,GAAG5B,QAAQ,CAACQ,aAAT,CAAuB,KAAvB,CAAT;AACAQ,EAAAA,MAAM,CAACY,EAAE,CAACX,KAAJ,EAAW;AACfC,IAAAA,QAAQ,EAAE,OADK;AAEfC,IAAAA,GAAG,EAAEA,GAAG,GAAG,IAFI;AAGfU,IAAAA,OAAO,EAAE,MAHM;AAIfJ,IAAAA,MAAM,EAAE,GAJO;AAKfK,IAAAA,MAAM,EAAE,gBALO;AAMfC,IAAAA,SAAS,EAAE,QANI;AAOfV,IAAAA,KAAK,EAAE,OAPQ;AAQfD,IAAAA,IAAI,EAAEA,IAAI,GAAG,IARE;AASfY,IAAAA,OAAO,EAAE,CATM;AAUfN,IAAAA,eAAe,EAAE;AAVF,GAAX,CAAN;AAYAE,EAAAA,EAAE,CAACX,KAAH,CAAStB,SAAT,IAAsB,YAAtB;AACAY,EAAAA,OAAO,CAACU,KAAR,CAAcrB,UAAd,IAA4B,kBAA5B;AACAgC,EAAAA,EAAE,CAACX,KAAH,CAASrB,UAAT,IAAuB,gDAAvB;AACAqC,EAAAA,UAAU,CAAC,YAAY;AACrBL,IAAAA,EAAE,CAACX,KAAH,CAAStB,SAAT,IAAsB,UAAtB;AACAiC,IAAAA,EAAE,CAACX,KAAH,CAASe,OAAT,GAAmB,GAAnB;AACAzB,IAAAA,OAAO,CAACU,KAAR,CAAcS,eAAd,GAAgC,iBAAhC;AACD,GAJS,EAIP,EAJO,CAAV;;AAKA,MAAIpB,GAAG,CAACW,KAAR,EAAe;AACbD,IAAAA,MAAM,CAACY,EAAE,CAACX,KAAJ,EAAWX,GAAG,CAACW,KAAf,CAAN;AACD;;AACD1B,EAAAA,OAAO,CAACqC,EAAD,CAAP,CAAYnB,GAAZ,CAAgB,gBAAhB;;AACA,MAAI,OAAOJ,GAAP,KAAe,QAAnB,EAA6B;AAC3BuB,IAAAA,EAAE,CAACM,SAAH,GAAe,UAAU7B,GAAV,GAAgB,QAA/B;AACD,GAFD,MAEO,IAAIA,GAAG,CAAC8B,QAAJ,KAAiB,CAArB,EAAuB;AAC5BP,IAAAA,EAAE,CAACD,WAAH,CAAetB,GAAf;AACD,GAFM,MAEA;AACL,UAAM,IAAI+B,KAAJ,CAAU,aAAa/B,GAAb,GAAmB,kBAA7B,CAAN;AACD;;AACDH,EAAAA,IAAI,CAACyB,WAAL,CAAiBC,EAAjB;AACAlC,EAAAA,QAAQ,GAAGA,QAAQ,CAAC2C,OAAT,CAAiB,UAAjB,EAA6B,UAAUC,IAAV,EAAgB;AACtD,QAAIA,IAAI,IAAI,OAAZ,EAAqB;AACnB,aAAOhC,GAAG,CAACiC,GAAJ,IAAW,KAAlB;AACD,KAFD,MAEO,IAAID,IAAI,IAAI,MAAZ,EAAoB;AACzB,aAAOhC,GAAG,CAACkC,EAAJ,IAAU,IAAjB;AACD;AACF,GANU,CAAX;AAOA,MAAIC,MAAM,GAAGjD,MAAM,CAACE,QAAD,CAAnB;AACAkC,EAAAA,EAAE,CAACD,WAAH,CAAec,MAAf;;AACA,MAAInC,GAAG,CAACoC,KAAR,EAAe;AACb,QAAIC,GAAG,GAAGF,MAAM,CAACG,aAAP,CAAqB,KAArB,CAAV;AACAD,IAAAA,GAAG,CAACE,UAAJ,CAAeC,WAAf,CAA2BH,GAA3B;AACD;;AAED,WAASI,OAAT,GAAmB;AACjB3D,IAAAA,KAAK,CAAC4D,IAAN,CAAWpB,EAAX,EAAe/B,aAAf,EAA8B,SAASoD,GAAT,GAAe;AAC3C7D,MAAAA,KAAK,CAAC8D,MAAN,CAAatB,EAAb,EAAiB/B,aAAjB,EAAgCoD,GAAhC;AACA,UAAIrB,EAAE,CAACiB,UAAP,EAAmB3C,IAAI,CAAC4C,WAAL,CAAiBlB,EAAjB;AACpB,KAHD;AAIAA,IAAAA,EAAE,CAACX,KAAH,CAASe,OAAT,GAAmB,CAAnB;AACAJ,IAAAA,EAAE,CAACX,KAAH,CAAStB,SAAT,IAAsB,mBAAtB;AACAO,IAAAA,IAAI,CAAC4C,WAAL,CAAiBvC,OAAjB;AACD;;AAED,SAAO,IAAI4C,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC5C/D,IAAAA,KAAK,CAACmD,MAAD,EAAQ,UAAUa,CAAV,EAAa;AACxB,UAAIC,GAAG,GAAGhE,OAAO,CAAC+D,CAAC,CAACE,MAAH,CAAjB;;AACA,UAAID,GAAG,CAACE,GAAJ,CAAQ,KAAR,CAAJ,EAAoB;AAClBV,QAAAA,OAAO;AACPK,QAAAA,OAAO;AACR,OAHD,MAGO,IAAIG,GAAG,CAACE,GAAJ,CAAQ,IAAR,CAAJ,EAAmB;AACxBV,QAAAA,OAAO;AACPM,QAAAA,MAAM;AACP;AACF,KATI,CAAL;AAUD,GAXM,CAAP;AAYD;;AAGD,SAASrC,MAAT,CAAgB0C,EAAhB,EAAoBC,IAApB,EAA0B;AACxBC,EAAAA,MAAM,CAACC,IAAP,CAAYF,IAAZ,EAAkBG,OAAlB,CAA0B,UAAUC,CAAV,EAAa;AACrCL,IAAAA,EAAE,CAACK,CAAD,CAAF,GAAQJ,IAAI,CAACI,CAAD,CAAZ;AACD,GAFD;AAGA,SAAOL,EAAP;AACD;;AAEDM,MAAM,CAACC,OAAP,GAAiB7D,OAAjB","sourcesContent":["var event = require('events')\nvar ontap = require('ontap')\nvar classes = require('classes')\nvar domify = require('domify')\nvar detect = require('prop-detect')\nvar template = require('./footer.html')\nvar transform = detect.transform\nvar transition = detect.transition\nvar transitionEnd = detect.transitionend\nvar root = document.compatMode=='BackCompat'? document.body : document.documentElement\n\nfunction Confirm(msg, opt) {\n  opt = opt || {}\n  var body = document.body\n  var overlay = document.createElement('div')\n  classes(overlay).add('confirm-overlay')\n  var rect = document.documentElement.getBoundingClientRect()\n  var w = root.clientWidth\n  var h = root.clientHeight\n  assign(overlay.style, {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: w + 'px',\n    height: Math.max(rect.height, h) + 'px',\n    zIndex: 998,\n    backgroundColor: 'rgba(0,0,0,0)'\n  })\n  body.appendChild(overlay)\n  var top = h/2 - 50\n  var left = w/2 - 100\n  var el = document.createElement('div')\n  assign(el.style, {\n    position: 'fixed',\n    top: top + 'px',\n    padding: '10px',\n    zIndex: 999,\n    border: '1px solid #000',\n    textAlign: 'center',\n    width: '200px',\n    left: left + 'px',\n    opacity: 0,\n    backgroundColor: '#fff'\n  })\n  el.style[transform] = 'scale(0.6)'\n  overlay.style[transition] = 'all 500ms linear'\n  el.style[transition] = 'all 250ms cubic-bezier(0.04, 0.76, 0.41, 0.99)'\n  setTimeout(function () {\n    el.style[transform] = 'scale(1)'\n    el.style.opacity = '1'\n    overlay.style.backgroundColor = 'rgba(0,0,0,0.4)'\n  }, 20)\n  if (opt.style) {\n    assign(el.style, opt.style)\n  }\n  classes(el).add('confirm-active')\n  if (typeof msg === 'string') {\n    el.innerHTML = '<div>' + msg + '</div>'\n  } else if (msg.nodeType === 1){\n    el.appendChild(msg)\n  } else {\n    throw new Error('typeof [' + msg + '] not recognized')\n  }\n  body.appendChild(el)\n  template = template.replace(/\\{\\w+\\}/g, function (word) {\n    if (word == '{yes}') {\n      return opt.yes || 'Yes'\n    } else if (word == '{no}') {\n      return opt.no || 'No'\n    }\n  })\n  var footer = domify(template)\n  el.appendChild(footer)\n  if (opt.alert) {\n    var btn = footer.querySelector('.no')\n    btn.parentNode.removeChild(btn)\n  }\n\n  function cleanUp() {\n    event.bind(el, transitionEnd, function end() {\n      event.unbind(el, transitionEnd, end)\n      if (el.parentNode) body.removeChild(el)\n    })\n    el.style.opacity = 0\n    el.style[transform] = 'translateY(-100%)'\n    body.removeChild(overlay)\n  }\n\n  return new Promise(function (resolve, reject) {\n    ontap(footer,function (e) {\n      var clz = classes(e.target)\n      if (clz.has('yes')) {\n        cleanUp()\n        resolve()\n      } else if (clz.has('no')) {\n        cleanUp()\n        reject()\n      }\n    })\n  })\n}\n\n\nfunction assign(to, from) {\n  Object.keys(from).forEach(function (k) {\n    to[k] = from[k]\n  })\n  return to\n}\n\nmodule.exports = Confirm\n"],"file":"index.dev.js"}